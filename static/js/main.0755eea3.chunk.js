(this["webpackJsonpreact-snake-game"]=this["webpackJsonpreact-snake-game"]||[]).push([[0],{40:function(e,t,a){e.exports=a(77)},45:function(e,t,a){},77:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(38),c=a.n(r),o=(a(45),a(1)),s=a(22),m=a(39),i={playerId:null,roomDetails:null,winnerPlayerId:null,gameOver:!1,gameState:null,reset:!1};function u(e,t){return Object(s.a)(Object(s.a)({},e),t)}var d,v=Object(n.createContext)({state:i,dispatch:function(){return null},socket:null,reset:function(){return null}}),f=function(e){var t=e.children,a=Object(n.useMemo)((function(){return Object(m.io)("http://localhost:4000")}),[]),r=Object(n.useReducer)(u,i),c=Object(o.a)(r,2),s=c[0],d=c[1],f=function(e){var t=JSON.parse(e)||null;d({gameState:t})};l.a.useEffect((function(){a.on("init",(function(e){return d({playerId:+e})})),a.on("room_details",(function(e){d({roomDetails:e})})),a.on("game_state",f),a.on("game_over",(function(e){return d({gameOver:!0,gameState:JSON.parse(e)})})),a.on("invalid_room",(function(){return alert("Invalid room!")})),a.on("room_full",(function(){return alert("Room already full!")}))}),[a]);return l.a.createElement(l.a.Fragment,null,a&&l.a.createElement(v.Provider,{value:{state:s,dispatch:d,socket:a,reset:function(){return d(i)}}},t))},E=function(){return Object(n.useContext)(v)},b=function(){var e,t,a=Object(n.useRef)(document.createElement("canvas"));l.a.useLayoutEffect((function(){a.current.focus()}),[]);var r=E(),c=r.state,s=r.socket,m=c.gameState;Object(n.useEffect)((function(){if(a.current){var e=a.current.getContext("2d");if(e&&m){e.setTransform(m.scale,0,0,m.scale,0,0),e.clearRect(0,0,m.canvasSize[0],m.canvasSize[1]),e.fillStyle="#aed565",e.fillRect(0,0,m.canvasSize[0],m.canvasSize[1]),m.players.forEach((function(t){var a=t.color,n=t.snake;t.status&&(e.fillStyle=a,n.forEach((function(t){var a=Object(o.a)(t,2),n=a[0],l=a[1];return e.fillRect(n,l,1,1)})))}));var t=m.food;e.fillStyle=m.foodColor,e.fillRect(t[0],t[1],1,1)}}}),[m]);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",null,m&&l.a.createElement(l.a.Fragment,null,l.a.createElement("canvas",{tabIndex:0,onKeyDown:function(e){return null===s||void 0===s?void 0:s.emit("keydown",e.key)},style:{border:"5px solid #75923e"},ref:a,width:null===(e=c.gameState)||void 0===e?void 0:e.canvasSize[0],height:null===(t=c.gameState)||void 0===t?void 0:t.canvasSize[1]}))))},p=function(){return l.a.createElement("div",{className:"modal fade",id:"exampleModal",tabIndex:-1,role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},l.a.createElement("div",{className:"modal-dialog",role:"document"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"Modal title"),l.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},l.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),l.a.createElement("div",{className:"modal-body"},"..."),l.a.createElement("div",{className:"modal-footer"},l.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),l.a.createElement("button",{type:"button",className:"btn btn-primary"},"Save changes")))))},y=function(){return l.a.createElement("img",{src:"/snake.png",alt:"snake"})},g=function(){var e=E().state,t=null===e||void 0===e?void 0:e.roomDetails,a=Object(n.useMemo)((function(){var e=new URL(window.location.href);return e.searchParams.set("id","".concat(null===t||void 0===t?void 0:t.roomId)),e.href}),[t]),r=function(e){if(""!==e){var t=document.createElement("input");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}};return l.a.createElement("div",{className:"vh-100 d-flex justify-content-center align-items-center"},l.a.createElement("div",null,l.a.createElement("h3",{className:"d-inline-block"},"Invite your friends to play"),l.a.createElement(y,null),l.a.createElement("div",{className:"text-center"},l.a.createElement("h4",{className:"text-primary"},"Room ID"),l.a.createElement("div",{className:"input-group m-auto",style:{width:300}},l.a.createElement("input",{type:"text",className:"form-control form-control-lg",readOnly:!0,value:null===t||void 0===t?void 0:t.roomId}),l.a.createElement("div",{className:"input-group-append"},l.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){return r((null===t||void 0===t?void 0:t.roomId)||"")}},"Copy"))),l.a.createElement("div",{className:"text-center d-block m-5"},l.a.createElement("button",{type:"button",className:"btn btn-info",onClick:function(){return r(a)},style:{backgroundColor:"4d498f"}},"Copy Link"),l.a.createElement("button",{type:"button",className:"btn btn-danger mx-3",onClick:function(){window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(a),"_blank")},style:{backgroundColor:"#4d498f"}},"Share to facebook")),l.a.createElement("div",{className:"mt-5"},"Waiting for the other players..."),l.a.createElement("br",null),l.a.createElement("div",null,"Connected players:\xa0",null===t||void 0===t?void 0:t.connectedPlayers," of"," ",null===t||void 0===t?void 0:t.noOfPlayers))))},h=function(e){var t=e.onCancel,a=E().socket,n=l.a.useState(""),r=Object(o.a)(n,2),c=r[0],s=r[1],m=l.a.useState(2),i=Object(o.a)(m,2),u=i[0],d=i[1],v=function(e){return d(+e.target.value)};return l.a.createElement("div",{className:"vh-100 d-flex justify-content-center align-items-center"},l.a.createElement("div",null,l.a.createElement("h3",{className:"d-inline-block"},"Create a multiplayer game"),l.a.createElement(y,null),l.a.createElement("div",{className:"mb-3"},l.a.createElement("span",{className:"pr-5"},"Enter your name"),l.a.createElement("input",{type:"text",className:"form-control form-control-lg",onChange:function(e){return s(e.target.value)}})),l.a.createElement("div",null,l.a.createElement("span",{className:"pr-5"},"How Many Players?"),l.a.createElement("select",{className:"form-control-lg",onChange:v,onBlur:v},function(){for(var e=[],t=1;t<=3;t++)t>1&&e.push(l.a.createElement("option",{key:t,value:t},t));return e}())),l.a.createElement("div",{className:"text-center d-block m-5"},l.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){""===c.trim()?alert("Please enter your name!"):null===a||void 0===a||a.emit("new_game",{name:c,noOfPlayers:u})}},"Create Game"),l.a.createElement("button",{type:"button",className:"btn btn-danger mx-3",onClick:t},"Cancel"))))},N=function(e){var t=e.onCancel,a=e.roomId,n=E().socket,r=l.a.useState(""),c=Object(o.a)(r,2),s=c[0],m=c[1],i=l.a.useState(a||""),u=Object(o.a)(i,2),d=u[0],v=u[1];return l.a.createElement("div",{className:"vh-100 d-flex justify-content-center align-items-center"},l.a.createElement("div",null,l.a.createElement("h3",{className:"d-inline-block"},"Join a Game"),l.a.createElement(y,null),l.a.createElement("div",{className:"mb-3"},l.a.createElement("span",{className:"pr-5"},"Enter your name:"),l.a.createElement("input",{type:"text",className:"form-control form-control-lg",onChange:function(e){m(e.target.value)}}),l.a.createElement("div",{className:"mb-3"},l.a.createElement("span",{className:"pr-5"},"Room ID"),l.a.createElement("input",{type:"text",value:d,className:"form-control form-control-lg",onChange:function(e){v(e.target.value)}}))),l.a.createElement("div",{className:"text-center d-block m-5"},l.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){""===s.trim()?alert("Please enter your name!"):""===d.trim()?alert("Please the Room ID!"):null===n||void 0===n||n.emit("join_game",{name:s,roomId:d})}},"Join Game"),l.a.createElement("button",{type:"button",className:"btn btn-danger mx-3",onClick:t},"Cancel"))))},k=function(){var e=l.a.useState(!1),t=Object(o.a)(e,2),a=t[0],r=t[1],c=l.a.useState(!1),s=Object(o.a)(c,2),m=s[0],i=s[1],u=Object(n.useMemo)((function(){return new URLSearchParams(window.location.search).get("id")}),[]);Object(n.useEffect)((function(){u&&i(!0)}),[u,m]);var d=E(),v=d.state,f=d.socket,b=function(){r(!1),i(!1)};return Object(n.useMemo)((function(){var e,t;return!!v.roomDetails&&(null===(e=v.roomDetails)||void 0===e?void 0:e.connectedPlayers)!==(null===(t=v.roomDetails)||void 0===t?void 0:t.noOfPlayers)}),[v.roomDetails])?l.a.createElement(g,null):a?l.a.createElement(h,{onCancel:b}):m?l.a.createElement(N,{roomId:u||"",onCancel:b}):l.a.createElement("div",{className:"vh-100 d-flex justify-content-center align-items-center"},l.a.createElement("div",null,l.a.createElement("h3",{className:"d-inline-block"},"Welcome to Snake Game"),l.a.createElement(y,null),l.a.createElement("div",{className:"text-center d-block"},l.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return null===f||void 0===f?void 0:f.emit("new_game")}},"Single Player"),l.a.createElement("button",{type:"button",className:"btn btn-success mx-3",onClick:function(){r(!0),i(!1)}},"Multiplayer"),l.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){r(!1),i(!0)}},"Join Game"),l.a.createElement(p,null))))},x=a(10),C=function(){var e,t=E().state;if(!t)return null;var a=t.gameState,n=[],r=[];null===a||void 0===a||a.players.forEach((function(e){e.status?n.push(e):r.push(e)}));var c=n.sort((function(e,t){return t.score-e.score})),o=r.sort((function(e,t){return t.score-e.score})),s=[].concat(Object(x.a)(c),Object(x.a)(o));return l.a.createElement(l.a.Fragment,null,1===s.length?l.a.createElement("h3",null,"Your score is: ",s[0].score):l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",null,l.a.createElement("ol",null,"Scoreboard")),l.a.createElement("ol",null,null===(e=[].concat(Object(x.a)(c),Object(x.a)(o)))||void 0===e?void 0:e.map((function(e){return l.a.createElement("li",{key:e.id},l.a.createElement("span",{style:{color:e.color,textDecoration:(null===e||void 0===e?void 0:e.status)||t.gameOver?"none":"line-through"}},e.name)," ","- ",e.score)})))))},O=function(){var e,t=E(),a=t.state,n=t.reset,r=t.socket,c=1===((null===a||void 0===a||null===(e=a.gameState)||void 0===e?void 0:e.players)||[]).length;return l.a.createElement("div",{className:"vh-100 d-flex align-items-".concat(c?"center":"start"),style:{justifyContent:"space-evenly"}},l.a.createElement("div",{className:"text-center pt-10"},l.a.createElement(y,null),l.a.createElement("h2",{className:"text-center text-danger"},"GAME OVER"),l.a.createElement("div",{className:"pt-5"},l.a.createElement(C,null)),l.a.createElement("div",{className:"text-center d-block mt-5"},l.a.createElement("button",{type:"button",className:"btn btn-success mr-5",onClick:function(){null===r||void 0===r||r.emit("new_game"),n()}},"Play again?"),l.a.createElement("button",{type:"button",className:"btn btn-success",onClick:n},"Home"))))},S=function(){var e,t,a,n,r=E().state,c=null===r||void 0===r||null===(e=r.gameState)||void 0===e||null===(t=e.players)||void 0===t||null===(a=t.filter((function(e){return(null===e||void 0===e?void 0:e.id)===r.playerId})))||void 0===a?void 0:a[0],o=(null===r||void 0===r||null===(n=r.gameState)||void 0===n?void 0:n.players)||[];return r.gameOver?l.a.createElement(O,null):l.a.createElement("div",{className:"vh-100 d-flex align-items-center",style:{justifyContent:"space-evenly"}},l.a.createElement("div",null),l.a.createElement("div",{className:"text-center"},l.a.createElement(b,null),l.a.createElement("h5",{className:"d-inline-block",style:{color:c.color}},"Your score: ",(null===c||void 0===c?void 0:c.score)||0)),l.a.createElement("div",{className:"pt-5"},o.length>1&&l.a.createElement(l.a.Fragment,null,!(null===c||void 0===c?void 0:c.status)&&l.a.createElement("h3",{className:"text-center text-danger mb-5"},"GAME OVER"),l.a.createElement(C,null))))},j=(d=function(){var e=E().state;return l.a.createElement("div",null,null===e.gameState?l.a.createElement(k,null):l.a.createElement(S,null))},function(){return l.a.createElement(f,null,l.a.createElement(d,null))});c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(j,null)),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.0755eea3.chunk.js.map